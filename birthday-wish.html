<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChÃºc Má»«ng Sinh Nháº­t</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="birthday-wish">
    <div class="wish-container">
        <h1 class="main-title">ğŸ‰ ChÃºc Má»«ng Sinh Nháº­t! ğŸ‰</h1>
        <div class="book-container">
            <div class="book" id="book" onclick="openBook()">
                <div class="book-cover">
                    <img src="images/anhbia.jpg" alt="Birthday Photo" class="cover-image">
                </div>
                <div class="book-page">
                    <div class="wish-content">
                        <div class="message">
                            <p class="message-line">HÃ´m nay lÃ  ngÃ y Ä‘áº·c biá»‡t cá»§a em,</p>
                            <p class="message-line">Má»™t ngÃ y Ä‘Ã¡nh dáº¥u thÃªm má»™t tuá»•i má»›i.</p>
                            <p class="message-line">ChÃºc em luÃ´n xinh Ä‘áº¹p, Ä‘Ã¡ng iu,</p>
                            <p class="message-line">ChÃºc tuá»•i má»›i mang Ä‘áº¿n nhiá»u niá»m vui,</p>
                            <p class="message-line">ChÃºc em cÃ³ Ä‘Æ°á»£c táº¥t cáº£! ğŸ’•</p>
                            <p class="message-line">VÃ  Æ°á»›c mÆ¡ cá»§a em sáº½ thÃ nh hiá»‡n thá»±c! ğŸ‚</p>
                        </div>
                        <div class="signature">
                            âœ¨ Vá»›i tÃ¬nh yÃªu thÆ°Æ¡ng âœ¨
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="click-hint" id="clickHint">ğŸ‘† Nháº¥p vÃ o sá»• Ä‘á»ƒ má»Ÿ nhÃ©!!!</div>

        <!-- NÃºt Ä‘iá»u khiá»ƒn nháº¡c -->
        <div class="music-control" id="musicControl" onclick="toggleMusic()">
            ğŸµ Báº­t nháº¡c
        </div>
        
        <div class="button-container">
            <a href="index.html" class="back-button">Quay láº¡i</a>
            <a href="gift.html" class="next-button">Tiáº¿p theo</a>
        </div>
    </div>

    <canvas class="confetti" id="confetti"></canvas>
    <div class="hearts-container" id="heartsContainer"></div>
    
    <!-- ThÃªm audio element -->
    <audio id="birthdayMusic" preload="auto">
        <source src="audio/birthday.mp3" type="audio/mpeg">
        <source src="audio/birthday-music.wav" type="audio/wav">
        <!-- Fallback cho cÃ¡c trÃ¬nh duyá»‡t khÃ´ng há»— trá»£ -->
        Your browser does not support the audio element.
    </audio>

    <script>
        function createConfetti() {
            const canvas = document.getElementById('confetti');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const confettiPieces = [];
            const colors = ['#ff9a9e', '#fecfef', '#fda085', '#ffb3ba', '#ff6b9d', '#ffc1cc'];

            for (let i = 0; i < 150; i++) {
                confettiPieces.push({
                    x: Math.random() * canvas.width,
                    y: -10,
                    width: Math.random() * 10 + 5,
                    height: Math.random() * 10 + 5,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    speed: Math.random() * 3 + 2,
                    rotation: Math.random() * 360
                });
            }

            function animateConfetti() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                confettiPieces.forEach((piece, index) => {
                    piece.y += piece.speed;
                    piece.rotation += 2;

                    ctx.save();
                    ctx.translate(piece.x + piece.width / 2, piece.y + piece.height / 2);
                    ctx.rotate(piece.rotation * Math.PI / 180);
                    ctx.fillStyle = piece.color;
                    ctx.fillRect(-piece.width / 2, -piece.height / 2, piece.width, piece.height);
                    ctx.restore();

                    if (piece.y > canvas.height) {
                        confettiPieces.splice(index, 1);
                    }
                });

                if (confettiPieces.length > 0) {
                    requestAnimationFrame(animateConfetti);
                }
            }

            animateConfetti();
        }

        function createHearts() {
            const heartsContainer = document.getElementById('heartsContainer');
            
            function addHeart() {
                const heart = document.createElement('div');
                heart.className = 'heart';
                heart.innerHTML = 'ğŸ’–';
                
                heart.style.left = Math.random() * 100 + '%';
                heart.style.animationDuration = (Math.random() * 3 + 5) + 's';
                heart.style.animationDelay = Math.random() * 2 + 's';
                
                heartsContainer.appendChild(heart);
                
                setTimeout(() => {
                    if (heart.parentNode) {
                        heart.parentNode.removeChild(heart);
                    }
                }, 8000);
            }
            
            const heartInterval = setInterval(addHeart, 800);
            
            setTimeout(() => {
                clearInterval(heartInterval);
            }, 20000);
        }

        // Báº¯t Ä‘áº§u hiá»‡u á»©ng khi trang load
        document.addEventListener('DOMContentLoaded', function() {
            createConfetti();
            createHearts();
            
            // Tá»± Ä‘á»™ng phÃ¡t nháº¡c khi user tÆ°Æ¡ng tÃ¡c (cho mobile)
            const music = document.getElementById('birthdayMusic');
            const musicControl = document.getElementById('musicControl');
            let musicStarted = false;
            
            function startMusicOnInteraction() {
                if (!musicStarted && music.paused) {
                    music.volume = 0.5;
                    music.play().then(() => {
                        musicControl.textContent = 'ğŸµ Táº¯t nháº¡c';
                        musicStarted = true;
                        console.log('Nháº¡c ná»n Ä‘Ã£ báº¯t Ä‘áº§u phÃ¡t!');
                    }).catch(e => console.log('KhÃ´ng thá»ƒ phÃ¡t nháº¡c:', e));
                }
            }
            
            // Láº¯ng nghe má»i loáº¡i tÆ°Æ¡ng tÃ¡c Ä‘á»ƒ báº­t nháº¡c
            document.addEventListener('click', startMusicOnInteraction, { once: true });
            document.addEventListener('touchstart', startMusicOnInteraction, { once: true });
            document.addEventListener('touchend', startMusicOnInteraction, { once: true });
        });

        function openBook() {
            const book = document.getElementById('book');
            const clickHint = document.getElementById('clickHint');
            const music = document.getElementById('birthdayMusic');
            const musicControl = document.getElementById('musicControl');
            
            book.classList.toggle('open');
            
            if (book.classList.contains('open')) {
                clickHint.textContent = 'ğŸ‘† Nháº¥p Ä‘á»ƒ Ä‘Ã³ng sá»•';
                clickHint.style.opacity = '0.7';
                
                // PhÃ¡t nháº¡c khi má»Ÿ sá»•
                music.currentTime = 0; // Reset vá» Ä‘áº§u bÃ i
                music.volume = 0.5; // Ã‚m lÆ°á»£ng 50%
                music.play().then(() => {
                    // Cáº­p nháº­t nÃºt khi nháº¡c phÃ¡t thÃ nh cÃ´ng
                    musicControl.textContent = 'ğŸµ Táº¯t nháº¡c';
                }).catch(error => {
                    console.log('KhÃ´ng thá»ƒ phÃ¡t nháº¡c:', error);
                    // Giá»¯ nguyÃªn nÃºt náº¿u khÃ´ng phÃ¡t Ä‘Æ°á»£c
                });
            } else {
                clickHint.textContent = 'ğŸ‘† Nháº¥p Ä‘á»ƒ má»Ÿ sá»•';
                clickHint.style.opacity = '1';
                
                // Dá»«ng nháº¡c khi Ä‘Ã³ng sá»•
                music.pause();
                music.currentTime = 0;
                // Cáº­p nháº­t nÃºt khi dá»«ng nháº¡c
                musicControl.textContent = 'ğŸµ Báº­t nháº¡c';
            }
        }

        function toggleMusic() {
            const music = document.getElementById('birthdayMusic');
            const musicControl = document.getElementById('musicControl');
            
            if (music.paused) {
                music.play().then(() => {
                    musicControl.textContent = 'ğŸµ Táº¯t nháº¡c';
                }).catch(error => {
                    console.log('KhÃ´ng thá»ƒ phÃ¡t nháº¡c:', error);
                });
            } else {
                music.pause();
                musicControl.textContent = 'ğŸµ Báº­t nháº¡c';
            }
        }
    </script>
</body>
</html>
