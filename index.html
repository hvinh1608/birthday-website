<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Chúc Mừng Sinh Nhật</title>
    <link rel="stylesheet" href="./style.css?v=6.0">
    <script>
        // Force CSS reload with timestamp
        document.addEventListener('DOMContentLoaded', function() {
            const link = document.querySelector('link[rel="stylesheet"]');
            const href = link.href;
            if (!href.includes('&t=')) {
                link.href = href + '&t=' + Date.now();
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <div class="left-section">
            <div class="birthday-image"></div>
        </div>
        
        <div class="right-section">
            <div class="keypad-container">
                <h2 class="keypad-title">Nhập Ngày Sinh</h2>
                <div class="password-display" id="passwordDisplay">_ _ _ _</div>
                
                <div class="keypad">
                    <button class="key" onclick="addDigit('1')">1</button>
                    <button class="key" onclick="addDigit('2')">2</button>
                    <button class="key" onclick="addDigit('3')">3</button>
                    <button class="key" onclick="addDigit('4')">4</button>
                    <button class="key" onclick="addDigit('5')">5</button>
                    <button class="key" onclick="addDigit('6')">6</button>
                    <button class="key" onclick="addDigit('7')">7</button>
                    <button class="key" onclick="addDigit('8')">8</button>
                    <button class="key" onclick="addDigit('9')">9</button>
                    <button class="btn btn-clear" onclick="clearPassword()">Xóa</button>
                    <button class="key" onclick="addDigit('0')">0</button>
                    <button class="btn btn-submit" onclick="submitPassword()">OK</button>
                </div>
            </div>
        </div>
    </div>

    <canvas class="confetti" id="confetti"></canvas>
    <div class="hearts-container" id="heartsContainer"></div>

    <script>
        // ==================== TOAST NOTIFICATION SYSTEM ====================
        function showToast(message, type = 'info', duration = 4000) {
            console.log('showToast called:', message, type);
            
            let container = document.querySelector('.toast-container');
            if (!container) {
                container = document.createElement('div');
                container.className = 'toast-container';
                document.body.appendChild(container);
                console.log('Toast container created');
            }

            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            toast.innerHTML = `
                <button class="toast-close" onclick="removeToast(this.parentElement)">&times;</button>
                <div>${message}</div>
                <div class="toast-progress"></div>
            `;

            container.appendChild(toast);

            setTimeout(() => {
                toast.classList.add('show');
            }, 100);

            const progress = toast.querySelector('.toast-progress');
            progress.style.width = '100%';
            
            setTimeout(() => {
                progress.style.width = '0%';
                progress.style.transition = `width ${duration}ms linear`;
            }, 200);

            setTimeout(() => {
                removeToast(toast);
            }, duration);

            return toast;
        }

        function removeToast(toast) {
            if (toast && toast.classList) {
                toast.classList.remove('show');
                setTimeout(() => {
                    if (toast.parentElement) {
                        toast.parentElement.removeChild(toast);
                    }
                }, 400);
            }
        }

        function showSuccess(message, duration = 3000) {
            return showToast(message, 'success', duration);
        }

        function showWarning(message, duration = 4000) {
            return showToast(message, 'warning', duration);
        }

        function showError(message, duration = 4000) {
            return showToast(message, 'error', duration);
        }

        function showInfo(message, duration = 4000) {
            return showToast(message, 'info', duration);
        }

        // Test function
        window.testToast = function() {
            showInfo('🎉 Toast system đang hoạt động!');
            setTimeout(() => showSuccess('✅ CSS đã load thành công!'), 1000);
            setTimeout(() => showWarning('⚠️ Đây là warning test!'), 2000);
            setTimeout(() => showError('❌ Đây là error test!'), 3000);
        };

        // Auto welcome toast
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Inline toast system loaded!');
            console.log('showToast function available:', typeof showToast === 'function');
            console.log('showSuccess function available:', typeof showSuccess === 'function');
            
            // Browser compatibility check
            const isOpera = (!!window.opr && !!opr.addons) || !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0;
            
            if (isOpera) {
                console.log('Opera detected - using alert fallback');
                setTimeout(() => {
                    alert('🎊 Chào mừng! Nhập mật khẩu để vào! (Opera mode)');
                }, 1000);
            } else {
                console.log('Modern browser detected - using toast');
                setTimeout(() => {
                    showInfo('🎊 Chào mừng! Nhập mật khẩu để vào!', 3000);
                }, 1000);
            }
        });
    </script>
    <script>
        console.log('About to load script.js');
        console.log('Toast functions available before script.js:', typeof showToast === 'function');
    </script>
    <script src="script.js"></script>
</body>
</html>